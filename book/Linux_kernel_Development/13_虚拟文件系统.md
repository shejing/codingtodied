# 虚拟文件系统
linux的虚拟文件系统是所有实际文件系统的抽象，实际的文件系统包括ext4, ntps, fat3等，vfs将这些组织起来，提供一个统一的接口供用户调用。

## 文件系统抽象层
用户空间调用write()函数时，首先调用VFS的sys_write(), sys_write()将判断要写入的文件描述符属于哪个实际的文件系统，然后执行该文件系统的write()调用。

## UNIX文件系统
+ 四个抽象概念： 文件，目录项，索引节点，安装点
+ 安装点： 在全局层次结构中称为**命名空间**
+ 文件：可以看作一个有序字符串，其中地一个字节是文件头，最后一个字节是文件尾
+ UNIX中把目录也看作文件
+ UNIX中将文件的相关信息和文件本身区分开来
+ 文件的相关信息：被称为文件的元数据，存储在索引节点inode中
+ 超级块 ： 存储文件系统相关信息

## 超级块
在文件系统安装时，文件系统会调用```alloc_super()```从磁盘读取文件系统超级块，并将这些信息填充到内存中的超级块对象```super_block```中。
超级块的操作可以用来控制文件系统本身的信息，也可以用来管理索引节点

## 索引节点
索引节点包含了内核在操作文件时所需的所有信息。一个索引节点代表文件系统中的一个文件，也可以是设备或者管道这样的特殊文件。
索引节点的操作保护了文件目录的操作，文件的链接，以及设置文件属性等。

## 目录项
目录项是为了方便查找操作而引入的。每个目录项代表路径中一个特定的部分，可以是一个目录或者文件，目录项对象没有对应的磁盘数据结构。
目录项包含三种状态：
+ 被使用：对应一个有效的索引节点，且该对象存在一个以上的使用者
+ 未被使用：对应一个有效的索引节点，但是没有使用者
+ 负状态：表示一个无效的目录项，没有对应的索引节点
目录项缓存：使用散列表的形式，保存路径名和目录项的映射，方便查找。只要目录项被缓存，其相应的索引节点也会被缓存(因为目录项增加了inode的引用计数)

## 文件对象
表示进程已经打开的文件，是已打开的文件在内存中的表示。同一个文件可以对应多个文件对象。
文件的操作包含常用的读写，指针偏移，io控制等。


